import{W as E,i as p,h as u}from"./handleGlobalError-BpL8gP2k.js";function f(t){const r=document.createDocumentFragment();return t.forEach(e=>{const n=document.createElement("article");n.dataset.id=String(e.id);const o=document.createElement("h2");o.innerText=e.jobTitle;const i=document.createElement("p");i.innerText=e.companyName;const a=document.createElement("p");a.innerText=e.workCityLocation;const d=document.createElement("p");d.innerText=e.startDate+" âŽ¯ "+e.endDate;const m=document.createElement("p");m.innerText=e.description;const c=document.createElement("div");c.classList.add("button-container");const s=document.createElement("button");s.innerText="Edit",s.classList.add("edit");const l=document.createElement("button");l.innerText="Delete",l.classList.add("delete"),c.appendChild(s),c.appendChild(l),n.appendChild(o),n.appendChild(i),n.appendChild(a),n.appendChild(d),n.appendChild(m),n.appendChild(c),r.appendChild(n)}),r}function h(t){const r=".work-experience-container",e=document.querySelector(r);if(!e){console.error(`DOM-element ${r} is missing.`);return}const n=f(t);e.appendChild(n)}async function w(){try{return await new E("https://dt207g-moment2.azurewebsites.net/api/work-experience").getAll()}catch(t){if(Array.isArray(t)&&t.every(r=>p(r))){const r=t;for(const e of r)u(document.body,e)}else console.error("Unexpected app error",t);return null}}const x="/DT207G-moment2-frontend/edit/";function T(t){const r=".edit",e=document.querySelectorAll(r);if(e.length===0){console.error(`DOM-element ${r} does not exist.`);return}e.forEach(n=>{const o=n.closest("article");if(!o){console.error("Article element to which this button belongs to does not exist.");return}for(const i of t)if(String(i.id)===o.dataset.id){n.addEventListener("click",()=>y(i));break}})}function y(t){localStorage.setItem("edit-entry",JSON.stringify(t)),window.location.href=x}function k(t){const r=".delete",e=document.querySelectorAll(r);if(e.length===0){console.error(`DOM-element ${r} does not exist.`);return}e.forEach(n=>{const o=n.closest("article");if(!o){console.error("Article element to which this button belongs to does not exist.");return}for(const i of t)if(String(i.id)===o.dataset.id){n.addEventListener("click",()=>C(i.id));break}})}async function C(t){const r=new E("https://dt207g-moment2.azurewebsites.net/api/work-experience");try{window.confirm("Are you sure?")&&(await r.delete(t),window.alert("Work experience has been deleted!"),window.location.reload())}catch(e){if(Array.isArray(e)&&e.every(n=>p(n))){const n=e;for(const o of n)u(document.body,o)}else console.error("Unexpected app error",e)}}async function g(){const t=await w();t&&(h(t),T(t),k(t))}g();
