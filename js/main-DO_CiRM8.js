import"./style-CEwA2oRX.js";import{W as E,i as u,h as f,B as h}from"./button-HNNbMc6K.js";function w(e){const r=document.createDocumentFragment();return e.forEach(n=>{const t=document.createElement("article");t.dataset.id=String(n.id);const o=document.createElement("h2");o.innerText=n.jobTitle;const i=document.createElement("p");i.innerText=n.companyName;const c=document.createElement("p");c.innerText=n.workCityLocation;const d=document.createElement("p");d.innerText=n.startDate+" âŽ¯ "+n.endDate;const m=document.createElement("p");m.innerText=n.description;const s=document.createElement("div");s.classList.add("button-container");const a=document.createElement("button");a.innerText="Edit",a.classList.add("edit");const p=document.createElement("i");p.classList.add("fa-solid","fa-gear","fa-spin");const l=document.createElement("button");l.classList.add("delete"),l.append(p,"Delete"),s.appendChild(a),s.appendChild(l),t.appendChild(o),t.appendChild(i),t.appendChild(c),t.appendChild(d),t.appendChild(m),t.appendChild(s),r.appendChild(t)}),r}function g(e){const r=".work-experience-container",n=document.querySelector(r);if(!n)return console.error(`DOM-element ${r} is missing.`),!1;if(e.length===0){const o=document.createElement("p");return o.innerText="There are no work experiences stored. Please add one from the add/ page.",!1}const t=w(e);return n.appendChild(t),!0}async function x(){try{return await new E("https://dt207g-moment2.azurewebsites.net/api/work-experience").getAll()}catch(e){if(Array.isArray(e)&&e.every(r=>u(r))){const r=e;for(const n of r)f(document.body,n)}else console.error("Unexpected app error",e);return null}}const T="/DT207G-moment2-frontend/edit/";function y(e){const r=".edit",n=document.querySelectorAll(r);if(n.length===0){console.error(`DOM-element ${r} does not exist.`);return}n.forEach(t=>{const o=t.closest("article");if(!o){console.error("Article element to which this button belongs to does not exist.");return}for(const i of e)if(String(i.id)===o.dataset.id){t.addEventListener("click",()=>k(i));break}})}function k(e){localStorage.setItem("edit-entry",JSON.stringify(e)),window.location.href=T}function C(e){const r=".delete",n=document.querySelectorAll(r);if(n.length===0){console.error(`DOM-element ${r} does not exist.`);return}n.forEach(t=>{const o=t.closest("article");if(!o){console.error("Article element to which this button belongs to does not exist.");return}for(const i of e)if(String(i.id)===o.dataset.id){t.addEventListener("click",()=>b(i.id,t));break}})}async function b(e,r){const n=new E("https://dt207g-moment2.azurewebsites.net/api/work-experience"),t=new h(r);try{window.confirm("Are you sure?")&&(t.disable(),t.showLoader(),await n.delete(e),window.alert("Work experience has been deleted!"),window.location.reload())}catch(o){if(t.enable(),t.showLoader(),Array.isArray(o)&&o.every(i=>u(i))){const i=o;for(const c of i)f(document.body,c)}else console.error("Unexpected app error",o)}}async function L(){const e=await x();e&&g(e)&&(y(e),C(e))}L();
