import"./style-CEwA2oRX.js";import{W as E,i as u,h as f,B as h}from"./button-HNNbMc6K.js";function w(e){const o=document.createDocumentFragment();return e.forEach(n=>{const t=document.createElement("article");t.dataset.id=String(n.id);const r=document.createElement("h2");r.innerText=n.jobTitle;const i=document.createElement("p");i.innerText=n.companyName;const c=document.createElement("p");c.innerText=n.workCityLocation;const d=document.createElement("p");d.innerText=n.startDate+" âŽ¯ "+n.endDate;const m=document.createElement("p");m.innerText=n.description;const s=document.createElement("div");s.classList.add("button-container");const a=document.createElement("button");a.innerText="Edit",a.classList.add("edit");const p=document.createElement("i");p.classList.add("fa-solid","fa-gear","fa-spin");const l=document.createElement("button");l.classList.add("delete"),l.append(p,"Delete"),s.appendChild(a),s.appendChild(l),t.appendChild(r),t.appendChild(i),t.appendChild(c),t.appendChild(d),t.appendChild(m),t.appendChild(s),o.appendChild(t)}),o}function x(e){const o=".work-experience-container",n=document.querySelector(o);if(!n){console.error(`DOM-element ${o} is missing.`);return}const t=w(e);n.appendChild(t)}async function g(){try{return await new E("https://dt207g-moment2.azurewebsites.net/api/work-experience").getAll()}catch(e){if(Array.isArray(e)&&e.every(o=>u(o))){const o=e;for(const n of o)f(document.body,n)}else console.error("Unexpected app error",e);return null}}const y="/DT207G-moment2-frontend/edit/";function T(e){const o=".edit",n=document.querySelectorAll(o);if(n.length===0){console.error(`DOM-element ${o} does not exist.`);return}n.forEach(t=>{const r=t.closest("article");if(!r){console.error("Article element to which this button belongs to does not exist.");return}for(const i of e)if(String(i.id)===r.dataset.id){t.addEventListener("click",()=>k(i));break}})}function k(e){localStorage.setItem("edit-entry",JSON.stringify(e)),window.location.href=y}function C(e){const o=".delete",n=document.querySelectorAll(o);if(n.length===0){console.error(`DOM-element ${o} does not exist.`);return}n.forEach(t=>{const r=t.closest("article");if(!r){console.error("Article element to which this button belongs to does not exist.");return}for(const i of e)if(String(i.id)===r.dataset.id){t.addEventListener("click",()=>b(i.id,t));break}})}async function b(e,o){const n=new E("https://dt207g-moment2.azurewebsites.net/api/work-experience"),t=new h(o);try{window.confirm("Are you sure?")&&(t.disable(),t.showLoader(),await n.delete(e),window.alert("Work experience has been deleted!"),window.location.reload())}catch(r){if(t.enable(),t.showLoader(),Array.isArray(r)&&r.every(i=>u(i))){const i=r;for(const c of i)f(document.body,c)}else console.error("Unexpected app error",r)}}async function L(){const e=await g();e&&(x(e),T(e),C(e))}L();
